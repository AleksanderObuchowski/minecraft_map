import nbtlib
import numpy as np

from PIL import Image


input_file = 'example_map'
output_file = 'example_rgb.png'

basecolors = [(255,255,255), (127, 178, 56), (247, 233, 163), (199, 199, 199),
    (255, 0, 0), (160, 160, 255), (167, 167, 167), (0, 124, 0),
    (255, 255, 255), (164, 168, 184), (151, 109, 77), (112, 112, 112),
    (64, 64, 255), (143, 119, 72), (255, 252, 245), (216, 127, 51),
    (178, 76, 216), (102, 153, 216), (229, 229, 51), (127, 204, 25),
    (242, 127, 165), (76, 76, 76), (153, 153, 153), (76, 127, 153),
    (127, 63, 178), (51, 76, 178), (102, 76, 51), (102, 127, 51),
    (153, 51, 51), (25, 25, 25), (250, 238, 77), (92, 219, 213),
(74, 128, 255), (0, 217, 58), (129, 86, 49), (112, 2, 0)]


allcolors = [(255,255,255), (255,255,255), (255,255,255), (255,255,255), (90, 126, 40),
    (110, 154, 48), (127, 178, 56), (67, 94, 30), (174, 164, 115),
    (213, 201, 141), (247, 233, 163), (131, 123, 86),
    (140, 140, 140), (172, 172, 172), (199, 199, 199),
    (105, 105, 105), (180, 0, 0), (220, 0, 0), (255, 0, 0),
    (135, 0, 0), (113, 113, 180), (138, 138, 220), (160, 160, 255),
    (85, 85, 135), (118, 118, 118), (144, 144, 144), (167, 167, 167),
    (88, 88, 88), (0, 88, 0), (0, 107, 0), (0, 124, 0), (0, 66, 0),
    (180, 180, 180), (220, 220, 220), (255, 255, 255), (135, 135, 135),
    (116, 119, 130), (141, 145, 159), (164, 168, 184), (87, 89, 97),
    (107, 77, 54), (130, 94, 66), (151, 109, 77), (80, 58, 41),
    (79, 79, 79), (97, 97, 97), (112, 112, 112), (59, 59, 59),
    (45, 45, 180), (55, 55, 220), (64, 64, 255), (34, 34, 135),
    (101, 84, 51), (123, 103, 62), (143, 119, 72), (76, 63, 38),
    (180, 178, 173), (220, 217, 211), (255, 252, 245),
    (135, 133, 130), (152, 90, 36), (186, 110, 44),
    (216, 127, 51), (114, 67, 27), (126, 54, 152),
    (154, 66, 186), (178, 76, 216), (94, 40, 114), (72, 108, 152),
    (88, 132, 186), (102, 153, 216), (54, 81, 114),
    (162, 162, 36), (198, 198, 44), (229, 229, 51),
    (121, 121, 27), (90, 144, 18), (110, 176, 22), (127, 204, 25),
    (67, 108, 13), (171, 90, 116), (209, 110, 142),
    (242, 127, 165), (128, 67, 87), (54, 54, 54), (66, 66, 66),
    (76, 76, 76), (40, 40, 40), (108, 108, 108), (132, 132, 132),
    (153, 153, 153), (81, 81, 81), (54, 90, 108), (66, 110, 132),
    (76, 127, 153), (40, 67, 81), (90, 44, 126), (110, 54, 154),
    (127, 63, 178), (67, 33, 94), (36, 54, 126), (44, 66, 154),
    (51, 76, 178), (27, 40, 94), (72, 54, 36), (88, 66, 44),
    (102, 76, 51), (54, 40, 27), (72, 90, 36), (88, 110, 44),
    (102, 127, 51), (54, 67, 27), (108, 36, 36), (132, 44, 44),
    (153, 51, 51), (81, 27, 27), (18, 18, 18), (22, 22, 22),
    (25, 25, 25), (13, 13, 13), (176, 168, 54), (216, 205, 66),
    (250, 238, 77), (132, 126, 41), (65, 155, 150),
    (79, 189, 184), (92, 219, 213), (49, 116, 113),
    (52, 90, 180), (64, 110, 220), (74, 128, 255), (39, 68, 135),
    (0, 153, 41), (0, 187, 50), (0, 217, 58), (0, 115, 31),
    (91, 61, 35), (111, 74, 42), (129, 86, 49), (68, 46, 26),
(79, 1, 0), (97, 2, 0), (112, 2, 0), (59, 1, 0)]





pixels_arr = np.zeros((128, 128, 3), dtype=np.uint8)

pixels = []
with nbtlib.load(input_file) as map:
	blocks =map.root['data']['colors']
	
for block in blocks:
	rgb = allcolors[int(block)]
	pixels.append( rgb)

for i in range(128*128):
	pixels_arr[int(i/128)][i%128] = pixels[i]
	

img = Image.fromarray(pixels_arr)
img = img.resize((1280,1280),Image.NEAREST)
img.save(output_file)
